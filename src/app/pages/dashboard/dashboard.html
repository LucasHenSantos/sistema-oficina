<div class="dashboard-container">
    <header class="header">
        <h1>VisÃ£o Geral</h1>
        <p class="date">Hoje, {{ 'now' | date:'dd/MM/yyyy' }}</p>
    </header>

    <div class="stats-grid">
        
        @if (loading()) {
             <div class="card stat-card full-span-loading">
                <p>Carregando dados do servidor...</p>
             </div>
        } @else {
        
            <div class="card stat-card blue">
                <div class="icon-box">ðŸš—</div>
                <div class="stat-info">
                    <h3>VeÃ­culos na Oficina</h3>
                    <h3 class="data-value">{{ vehiclesInProgress() }}</h3>
                    <span class="subtext">OS em Andamento/Pendente</span>
                </div>
            </div>
            
            <div class="card stat-card green">
                <div class="icon-box">ðŸ’µ</div>
                <div class="stat-info">
                    <h3>Faturamento do Dia</h3>
                    <h3 class="data-value">{{ dailyRevenue() | currency:'BRL':'symbol':'1.2-2' }}</h3>
                    <span class="subtext">Total de OS Finalizadas hoje</span>
                </div>
            </div>
            
            <div class="card stat-card red">
                <div class="icon-box">ðŸ“¦</div>
                <div class="stat-info">
                    <h3>Estoque Baixo</h3>
                    <h3 class="data-value">{{ lowStockCount() }}</h3>
                    <span class="subtext">Itens abaixo do mÃ­nimo</span>
                </div>
            </div>
        }
    </div>

    <div class="content-grid">
        
        <div class="card activity-card">
            <h2>ðŸ”” Atividades Recentes</h2>
            
            @if (loading()) {
                <ul class="activity-list"><li><span class="time">...</span><span class="text">Carregando atividades...</span></li></ul>
            } @else if (recentActivities().length === 0) {
                 <div class="empty-state">
                    <p>Nenhuma OS recente.</p>
                 </div>
            } @else {
                <ul class="activity-list">
                    @for (activity of recentActivities(); track activity.id) {
                        <li [class]="activity.status | lowercase">
                            <span class="time">{{ formatDate(activity.date) }}</span>
                            <span class="text">
                                OS #{{ activity.id }} - {{ activity.client }} ({{ activity.vehicle }})
                            </span>
                        </li>
                    }
                </ul>
            }
        </div>

        <div class="card actions-card">
            <h2>ðŸš€ AÃ§Ãµes RÃ¡pidas</h2>
            <div class="actions-buttons">
                <a class="btn-action" routerLink="/veiculos" [queryParams]="{ open: 'true' }">
                    Nova Entrada de VeÃ­culo
                </a>
                
                <a class="btn-action" routerLink="/orcamentos" [queryParams]="{ open: 'true' }">
                    Novo OrÃ§amento
                </a>
                
                <a class="btn-action" routerLink="/produtos" [queryParams]="{ open: 'true' }">
                    Novo Produto (PeÃ§a)
                </a>
            </div>
        </div>
    </div>
</div>